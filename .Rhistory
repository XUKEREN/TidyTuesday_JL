}
tree.plot(12)
# test it
p1 <- tree.plot(10)
p1
tree.plot(2)
# print all plots in a list
treelist2 <- list()
for(i in 1:N2){
treelist2[[i+8]] <-   tree.plot(i)
}
# ggarrange the list
trees2 <- ggpubr::ggarrange(plotlist = treelist2,ncol=10,nrow=7)
#color the background
trees3 <- cowplot::ggdraw(trees2) +
theme(plot.background = element_rect(fill="ghostwhite", color = NA))
trees3
tree.plot <- function(i=10,list=dlist2) {
# make color
pal <- carto.pal("green.pal",n1=nrow(songs %>% filter(year %in% dlist2[i]) %>% distinct(songid)) )
# make plot
if(length(pal) > 0){
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
geom_bar(stat="identity") +
scale_fill_manual(values = pal)+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
} else {
ggplot()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i]))
}
}
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill="darkgreen"  )) +
geom_bar(stat="identity") +
scale_fill_manual(values = pal)+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
tree.plot <- function(i=10,list=dlist2) {
# make color
pal <- carto.pal("green.pal",n1=nrow(songs %>% filter(year %in% dlist2[i]) %>% distinct(songid)) )
# make plot
if(length(pal) > 0){
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill="darkgreen"  )) +
geom_bar(stat="identity") +
scale_fill_manual(values = pal)+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
} else {
ggplot()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i]))
}
}
# test it
tree.plot(10)
tree.plot(2)
tree.plot <- function(i=10,list=dlist2) {
# make color
pal <- carto.pal("green.pal",n1=nrow(songs %>% filter(year %in% dlist2[i]) %>% distinct(songid)) )
# make plot
if(length(pal) > 0){
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill="green"  )) +
geom_bar(stat="identity") +
scale_fill_manual(values = pal)+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
} else {
ggplot()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i]))
}
}
# test it
tree.plot(10)
tree.plot(2)
tree.plot <- function(i=10,list=dlist2) {
# make color
pal <- carto.pal("green.pal",n1=nrow(songs %>% filter(year %in% dlist2[i]) %>% distinct(songid)) )
# make plot
if(length(pal) > 0){
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill="green"  )) +
geom_bar(stat="identity") +
#  scale_fill_manual(values = pal)+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
} else {
ggplot()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i]))
}
}
# test it
tree.plot(10)
tree.plot(2)
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill="green"  )) +
geom_bar(stat="identity") +
#  scale_fill_manual(values = pal)+
scale_fill_brewer()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
tree.plot <- function(i=10,list=dlist2) {
# make color
pal <- carto.pal("green.pal",n1=nrow(songs %>% filter(year %in% dlist2[i]) %>% distinct(songid)) )
# make plot
if(length(pal) > 0){
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill="green"  )) +
geom_bar(stat="identity") +
#  scale_fill_manual(values = pal)+
scale_fill_brewer()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
} else {
ggplot()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i]))
}
}
# test it
tree.plot(10)
tree.plot(2)
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill="green"  )) +
geom_bar(stat="identity") +
#  scale_fill_manual(values = pal)+
scale_fill_manual() +
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
tree.plot <- function(i=10,list=dlist2) {
# make color
pal <- carto.pal("green.pal",n1=nrow(songs %>% filter(year %in% dlist2[i]) %>% distinct(songid)) )
# make plot
if(length(pal) > 0){
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill="green"  )) +
geom_bar(stat="identity") +
#  scale_fill_manual(values = pal)+
scale_fill_manual() +
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
} else {
ggplot()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i]))
}
}
# test it
tree.plot(10)
tree.plot(2)
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill="green"  )) +
geom_bar(stat="identity") +
#  scale_fill_manual(values = pal)+
scale_fill_manual() +
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic(values=c("green"))+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks ), fill="darkgreen") +
geom_bar(stat="identity") +
#  scale_fill_manual(values = pal)+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
tree.plot <- function(i=10,list=dlist2) {
# make color
pal <- carto.pal("green.pal",n1=nrow(songs %>% filter(year %in% dlist2[i]) %>% distinct(songid)) )
# make plot
if(length(pal) > 0){
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks ), fill="darkgreen") +
geom_bar(stat="identity") +
#  scale_fill_manual(values = pal)+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
} else {
ggplot()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i]))
}
}
# test it
tree.plot(10)
tree.plot(2)
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks ), fill="darkgreen") +
geom_bar(stat="identity") +
#  scale_fill_manual(values = pal)+
scale_fill_brewer()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks )) +
#geom_bar(stat="identity") +
geom_bar(stat="identity",fill="darkgreen") +
#  scale_fill_manual(values = pal)+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
tree.plot <- function(i=10,list=dlist2) {
# make color
pal <- carto.pal("green.pal",n1=nrow(songs %>% filter(year %in% dlist2[i]) %>% distinct(songid)) )
# make plot
if(length(pal) > 0){
songs %>% select(song,weeks_on_chart,year,songid) %>%
group_by(year) %>%
filter(year %in% c(dlist2[i])) %>%
mutate(weeks_on_chart_cent = weeks_on_chart/2 ) %>%
mutate(weeks_on_chart_cent_neg = -weeks_on_chart_cent) %>%
gather_(key="original",value_col = "weeks",gather_cols=c("weeks_on_chart_cent","weeks_on_chart_cent_neg")) %>%
distinct() %>%
#ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks,fill=reorder(songid,weeks_on_chart)  )) +
ggplot(aes(x=reorder(songid,-weeks_on_chart),y=weeks )) +
#geom_bar(stat="identity") +
geom_bar(stat="identity",fill="darkgreen") +
#  scale_fill_manual(values = pal)+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i])) +
geom_point(inherit.aes = F, aes(y=0,x=length(pal)+1),shape=8,stroke=.5,color="darkgoldenrod1",size=.8)+
geom_polygon(inherit.aes=F,data=data.frame(x = c(-1,-1, .6, .6),y = c(-.8, .8, .8, -.8)),aes(x = x, y = y),
fill = "tan4")
} else {
ggplot()+
coord_flip(xlim = c(0,15),ylim = c(-11,11) ) +
theme_classic()+
theme(legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())+
annotate(geom="text",y=-10,x=14,hjust=0,label=paste(dlist2[i]))
}
}
# test it
tree.plot(10)
tree.plot(2)
# print all plots in a list
treelist2 <- list()
for(i in 1:N2){
treelist2[[i+8]] <-   tree.plot(i)
}
# ggarrange the list
trees2 <- ggpubr::ggarrange(plotlist = treelist2,ncol=10,nrow=7)
#color the background
trees3 <- cowplot::ggdraw(trees2) +
theme(plot.background = element_rect(fill="ghostwhite", color = NA))
trees3
tree.plot(3)
ggsave(trees3)
ggsave(trees3,device = NULL)
ggsave(trees3,device = cairo_ps())
ggsave(trees3,device = cairo_ps(),filename = here::here("trees.pdf"))
here::here()
ggsave(trees3,device = cairo_ps(),filename = here::here("trees.pdf"),height = 10,width = 14)
ggsave(trees3,
device = cairo_ps(),
filename = here::here("trees.pdf"),
height = 10,
width = 14,
dpi = 200)
